<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
</head>

<body>

    <header class="pro-header" id="header">
        <div class="logo">FileFlex</div>

        <nav>
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="#imgtopdf">Image to PDF</a></li>
                <li><a href="#wordtopdf">Word to PDF</a></li>
                <li><a href="#summary">Paragraph Summarizer</a></li>
                <li><a href="#imgttxt">Image to Text</a></li>
                <li><a href="#mergepdfs">Merge PDFs</a></li>
                <li><a href="#splitpdfs">Split PDFs</a></li>

            </ul>
        </nav>

    </header>

    <script>
        window.addEventListener("scroll", () => {
            const header = document.getElementById("header");
            if (window.scrollY > 70) {
                header.classList.add("shrink");
            } else {
                header.classList.remove("shrink");
            }
        });
    </script>

    <!--home-->

    <section class="ff-home" id="home">
        <div class="ff-blob1"></div>
        <div class="ff-blob2"></div>

        <div class="ff-container">
            <div class="ff-content">
                <h1 class="ff-title">FileFlex Converter</h1>
                <p class="ff-desc">
                    Convert PDFs, Images, Paragraphs and Documents instantly with
                    <span>AI-powered accuracy</span> and lightning-fast processing.
                </p>

                <div class="ff-buttons">
                    <a href="#imgtopdf" class="ff-btn ff-primary">Start Converting</a>
                    <a href="#imgtopdf" class="ff-btn ff-outline">View Tools</a>
                </div>
            </div>

            <div class="ff-visual">
                <div class="ff-glass-card">
                    <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="icon">
                </div>
            </div>
        </div>
    </section>


    <!--home end-->

    <link rel="stylesheet" href="style.css">

    <div class="imgtopdf" id="imgtopdf">
        <h2 class="imgtopdfheader">Image To PDF</h2>
        <!-- Hidden file input -->
        <input type="file" id="fileInput" accept="image/*" style="display:none" onchange="loadfile(event)">

        <!-- Custom button -->
        <button type="button" onclick="document.getElementById('fileInput').click()">Choose File</button>

        <!-- Display selected filename -->
        <span id="fileName">No file chosen</span>

        <!-- PDF download button -->
        <button class="imgpdfdwnload" onclick="pdfDown()">Download PDF</button>
        <br><br>

        <!-- Image preview -->
        <img id="showImg" width="200">
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        let newImage;

        function loadfile(event) {
            const file = event.target.files[0];
            const fileNameSpan = document.getElementById('fileName');

            if (file) {
                fileNameSpan.textContent = file.name; // Show filename separately
                newImage = new Image();
                newImage.src = URL.createObjectURL(file);
                document.getElementById('showImg').src = newImage.src;
            } else {
                fileNameSpan.textContent = 'No file chosen'; // Reset if no file
            }
        }

        async function pdfDown() {
            if (!newImage) {
                alert("Please upload an image first");
                return;
            }

            await new Promise(resolve => {
                if (newImage.complete) resolve();
                newImage.onload = resolve;
            });

            let canvas = document.createElement("canvas");
            canvas.width = newImage.width;
            canvas.height = newImage.height;
            let ctx = canvas.getContext("2d");
            ctx.drawImage(newImage, 0, 0);
            let base64 = canvas.toDataURL("image/jpeg");

            const { jsPDF } = window.jspdf;
            let doc = new jsPDF("p", "mm", "a4");

            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const pxToMm = px => px * 0.264583;

            let imgWidth_mm = pxToMm(newImage.width);
            let imgHeight_mm = pxToMm(newImage.height);

            const scale = Math.min(pageWidth / imgWidth_mm, pageHeight / imgHeight_mm, 1);
            imgWidth_mm *= scale;
            imgHeight_mm *= scale;

            const x = (pageWidth - imgWidth_mm) / 2;
            const y = (pageHeight - imgHeight_mm) / 2;

            doc.addImage(base64, "JPEG", x, y, imgWidth_mm, imgHeight_mm);
            doc.save("imgToPDF.pdf");
        }
    </script>




    <!--word to pdf-->

    <div>

        <div class="wordtopdf" id="wordtopdf">
            <h2 class="wordtopdfdheader"> Word To PDF</h2>

            <!-- Hidden file input -->
            <input type="file" id="docxFile" accept=".docx">
            <!-- PDF download button -->
            <button class="wrdpdfdwnload" onclick="convertDocxToPdf()">Convert to PDF</button>
            <br><br>

            <div id="preview" style="display:none;"></div>


        </div>

        <!-- Mammoth -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js"></script>

        <!-- jsPDF + html2canvas -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


        <script>
            async function convertDocxToPdf() {
                const fileInput = document.getElementById("docxFile");
                if (fileInput.files.length === 0) {
                    alert("Choose a DOCX file first");
                    return;
                }

                const file = fileInput.files[0];
                const arrayBuffer = await file.arrayBuffer();

                // DOCX → HTML (keeps formatting)
                const result = await mammoth.convertToHtml({ arrayBuffer });
                const html = result.value;

                const preview = document.getElementById("preview");
                preview.innerHTML = html;
                preview.style.width = "800px"; // A4 width approx.
                preview.style.padding = "20px";
                preview.style.background = "white";
                preview.style.display = "block";

                // Capture HTML as image
                const canvas = await html2canvas(preview, { scale: 2 });
                const imgData = canvas.toDataURL("image/png");

                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF("p", "mm", "a4");

                const pdfWidth = 210;
                const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

                pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
                pdf.save("WordToPDF.pdf");
            }
        </script>

    </div>

    <!--summary-->

    <div>


        <div class="summery" id="summary">
            <h2 class="summeryheader">Automatic Paragraph Summarizer</h2>
            <textarea id="inputText" placeholder="Paste your paragraph here..."></textarea>
            <br>
            <button class="summerzebtn" onclick="summarize()">Generate Summary</button>
            <div id="summary"></div>

        </div>


        <script>
            function summarize() {
                const text = document.getElementById('inputText').value;
                if (!text) { alert("Please enter a paragraph!"); return; }

                // Split into sentences
                const sentences = text.match(/[^.!?]+[.!?]+/g) || [text];

                // Count word frequencies
                const words = text.toLowerCase().match(/\b\w+\b/g);
                const freq = {};
                words.forEach(w => {
                    if (!['the', 'and', 'of', 'to', 'a', 'in', 'is', 'are', 'as', 'for', 'on', 'with', 'by', 'an', 'that', 'this'].includes(w)) {
                        freq[w] = (freq[w] || 0) + 1;
                    }
                });

                // Score each sentence
                const sentenceScores = sentences.map(s => {
                    let score = 0;
                    const sWords = s.toLowerCase().match(/\b\w+\b/g) || [];
                    sWords.forEach(w => { if (freq[w]) score += freq[w]; });
                    return { sentence: s, score };
                });

                // Sort sentences by score and pick top 2
                sentenceScores.sort((a, b) => b.score - a.score);
                const topSentences = sentenceScores.slice(0, 2).map(s => s.sentence).join(' ');

                document.getElementById('summary').innerText = topSentences;
            }
        </script>
    </div>


    <!--image to text-->


    <div>
        <div class="imgttxt" id="imgttxt">
            <h2 class="imgtotxtheader">Image to Text Converter</h2>
            <input type="file" id="imageInput" accept="image/*">
            <button class="imgtotxtbtn" id="convertBtn">Convert to Text</button>
            <div id="loader" style="display:none;">Processing...</div>
            <p class="hder">Extracted Text:</p>
            <textarea id="result" readonly></textarea>
        </div>
        <!-- Tesseract.js -->
        <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4.1.1/dist/tesseract.min.js"></script>
        <script src="script.js"></script>
        <script>
            const imageInput = document.getElementById('imageInput');
            const convertBtn = document.getElementById('convertBtn');
            const result = document.getElementById('result');
            const loader = document.getElementById('loader');

            convertBtn.addEventListener('click', () => {
                if (!imageInput.files[0]) {
                    alert("Please select an image!");
                    return;
                }

                const imageFile = imageInput.files[0];
                result.value = "";
                loader.style.display = "block";

                Tesseract.recognize(
                    imageFile,
                    'eng',
                    { logger: m => console.log(m) }
                ).then(({ data: { text } }) => {
                    loader.style.display = "none";
                    result.value = text;
                }).catch(err => {
                    loader.style.display = "none";
                    alert("Error: " + err.message);
                });
            });

        </script>

    </div>


    <!--merge pdfs-->

    <div>
        <div class="mergepdfs" id="mergepdfs">
            <h2 class="mergepdfheader">Merge PDFs</h2>
            <input type="file" id="pdfFiles" accept="application/pdf" multiple>
            <button class="mergeBtn" id="mergeBtn">Merge PDFs</button>
            <p id="status"></p>
        </div>

        <!-- pdf-lib -->
        <script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>
        <script src="script.js"></script>

        <script>
            const pdfFiles = document.getElementById('pdfFiles');
            const mergeBtn = document.getElementById('mergeBtn');
            const status = document.getElementById('status');

            mergeBtn.addEventListener('click', async () => {
                const files = pdfFiles.files;

                if (!files.length) {
                    alert("Please select 2–5 PDF files!");
                    return;
                }

                if (files.length < 2 || files.length > 5) {
                    alert("You can merge only 2 to 5 PDF files at a time.");
                    return;
                }

                status.textContent = "Merging PDFs...";

                const mergedPdf = await PDFLib.PDFDocument.create();

                for (const file of files) {
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                    const copiedPages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                    copiedPages.forEach(page => mergedPdf.addPage(page));
                }

                const mergedPdfBytes = await mergedPdf.save();
                const blob = new Blob([mergedPdfBytes], { type: 'application/pdf' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'merged.pdf';
                link.click();

                status.textContent = "Merge complete!";
            });
        </script>
    </div>

    <!--split PDF-->


    <div>
        <div class="splitpdf" id="splitpdfs">
            <h2 class="splitpdfheader">PDF Splitter</h2>
            <input type="file" id="pdfFile" accept="application/pdf">
            <div class="info">Enter pages or ranges to split (e.g., 1-3,5,7-9):</div>
            <input type="text" id="pages" placeholder="e.g., 1-2,4,6-7">
            <button class="splitpdfbtn" onclick="splitPDF()">Split PDF</button>
        </div>


        <script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>
        <script>
            async function splitPDF() {
                const fileInput = document.getElementById('pdfFile');
                const pagesInput = document.getElementById('pages').value;
                if (!fileInput.files[0]) {
                    alert('Please select a PDF file!');
                    return;
                }
                if (!pagesInput) {
                    alert('Please enter pages to split!');
                    return;
                }

                const file = fileInput.files[0];
                const arrayBuffer = await file.arrayBuffer();
                const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                const totalPages = pdfDoc.getPageCount();

                // Parse user input
                const ranges = pagesInput.split(',').map(r => r.trim()).filter(r => r);
                const pagesToExtract = [];
                ranges.forEach(r => {
                    if (r.includes('-')) {
                        let [start, end] = r.split('-').map(Number);
                        if (start < 1) start = 1;
                        if (end > totalPages) end = totalPages;
                        for (let i = start; i <= end; i++) pagesToExtract.push(i - 1);
                    } else {
                        const p = Number(r);
                        if (p >= 1 && p <= totalPages) pagesToExtract.push(p - 1);
                    }
                });

                // Create new PDF with selected pages
                const newPdf = await PDFLib.PDFDocument.create();
                const copiedPages = await newPdf.copyPages(pdfDoc, pagesToExtract);
                copiedPages.forEach(p => newPdf.addPage(p));

                const pdfBytes = await newPdf.save();
                const blob = new Blob([pdfBytes], { type: "application/pdf" });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'split.pdf';
                link.click();
            }
        </script>



    </div>








</body>


<footer class="footer">
    © 2025 FileFlex. All rights reserved. |
    <div class="ftr">
        <a href="/privacy" style="color: rgb(0, 0, 0);">Privacy Policy</a> |
        <a href="/terms" style="color: rgb(0, 0, 0);">Terms of Service</a> |
        <a href="/contact" style="color: rgb(0, 0, 0);">Contact Us</a>
    </div>

</footer>

</html>